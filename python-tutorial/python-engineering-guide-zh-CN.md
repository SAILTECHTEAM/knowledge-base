# Python å·¥ç¨‹æŒ‡å—ï¼šç°ä»£å¼€å‘å®è·µ

## ç›®å½•
1. [Python å·¥ç¨‹ç®€ä»‹](#python-å·¥ç¨‹ç®€ä»‹)
2. [é¡¹ç›®åˆå§‹åŒ–ä¸é…ç½®](#é¡¹ç›®åˆå§‹åŒ–ä¸é…ç½®)
3. [å¼€å‘ç¯å¢ƒç®¡ç†](#å¼€å‘ç¯å¢ƒç®¡ç†)
4. [ä»£ç è´¨é‡ä¸è§„èŒƒ](#ä»£ç è´¨é‡ä¸è§„èŒƒ)
5. [æµ‹è¯•ä¸è´¨é‡ä¿éšœ](#æµ‹è¯•ä¸è´¨é‡ä¿éšœ)
6. [ä¾èµ–ç®¡ç†](#ä¾èµ–ç®¡ç†)
7. [æŒç»­é›†æˆä¸éƒ¨ç½²](#æŒç»­é›†æˆä¸éƒ¨ç½²)
8. [æ–‡æ¡£ä¸ç»´æŠ¤](#æ–‡æ¡£ä¸ç»´æŠ¤)
9. [æ€§èƒ½ä¸ä¼˜åŒ–](#æ€§èƒ½ä¸ä¼˜åŒ–)
10. [å®‰å…¨æœ€ä½³å®è·µ](#å®‰å…¨æœ€ä½³å®è·µ)

---

## Python å·¥ç¨‹ç®€ä»‹

### ä»€ä¹ˆæ˜¯ Python å·¥ç¨‹ï¼Ÿ

Python å·¥ç¨‹æ¶µç›–äº†ä½¿ç”¨ç°ä»£å·¥å…·ã€å®è·µå’Œæ–¹æ³•è®ºç³»ç»Ÿæ€§åœ°å¼€å‘ã€éƒ¨ç½²å’Œç»´æŠ¤ Python åº”ç”¨çš„å…¨è¿‡ç¨‹ã€‚å®ƒä¸ä»…ä»…æ˜¯ç¼–å†™ Python ä»£ç ï¼Œè¿˜åŒ…æ‹¬ä»é¡¹ç›®åˆå§‹åŒ–åˆ°ç”Ÿäº§éƒ¨ç½²ã€é•¿æœŸç»´æŠ¤çš„æ•´ä¸ªè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸã€‚

### æ ¸å¿ƒåŸåˆ™

| åŸåˆ™ | æè¿° | é‡è¦æ€§ |
|------|------|--------|
| **è‡ªåŠ¨åŒ–** | è‡ªåŠ¨åŒ–é‡å¤æ€§ä»»åŠ¡å’Œæµç¨‹ | é™ä½äººä¸ºé”™è¯¯ï¼Œæé«˜æ•ˆç‡ |
| **ä¸€è‡´æ€§** | ä½¿ç”¨æ ‡å‡†åŒ–å·¥å…·å’Œå·¥ä½œæµ | æå‡å›¢é˜Ÿåä½œå’Œä»£ç è´¨é‡ |
| **å¯å¤ç°æ€§** | ç¡®ä¿æ„å»ºå’Œç¯å¢ƒä¸€è‡´ | ä¾¿äºå¯é éƒ¨ç½²å’Œè°ƒè¯• |
| **å¯æ‰©å±•æ€§** | è®¾è®¡å¯æ‰©å±•å’Œå¯ç»´æŠ¤ | è®©ä»£ç åº“å…·å¤‡æœªæ¥é€‚åº”æ€§ |
| **å®‰å…¨æ€§** | ä»ä¸€å¼€å§‹å°±å®æ–½å®‰å…¨æªæ–½ | é˜²æ­¢æ¼æ´å’Œæ•°æ®æ³„éœ² |

### å·¥ç¨‹åŒ– vs è„šæœ¬åŒ–

| æ–¹é¢ | è„šæœ¬åŒ– | å·¥ç¨‹åŒ– |
|------|--------|--------|
| **èŒƒå›´** | å•ä¸€ç”¨é€”ï¼Œå°è§„æ¨¡ | å¤æ‚ç³»ç»Ÿï¼Œå¤§è§„æ¨¡ |
| **ç»“æ„** | ç®€å•çº¿æ€§ | æ¨¡å—åŒ–ã€ç»„ç»‡åŒ– |
| **æµ‹è¯•** | æå°‘æˆ–æ—  | å®Œå–„æµ‹è¯•ä½“ç³» |
| **ä¾èµ–** | æ‰‹åŠ¨ã€ä¸´æ—¶ | ç®¡ç†ã€ç‰ˆæœ¬åŒ– |
| **éƒ¨ç½²** | æ‰‹åŠ¨æ‰§è¡Œ | è‡ªåŠ¨åŒ–æµæ°´çº¿ |
| **ç»´æŠ¤** | è¢«åŠ¨ | ä¸»åŠ¨ |

---

## é¡¹ç›®åˆå§‹åŒ–ä¸é…ç½®

### ç°ä»£é¡¹ç›®ç»“æ„

ä¸€ä¸ªç»“æ„åˆç†çš„ Python é¡¹ç›®åº”éµå¾ªå¦‚ä¸‹çº¦å®šï¼š

```
project-name/
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ .python-version         # Python ç‰ˆæœ¬æŒ‡å®š
â”œâ”€â”€ pyproject.toml          # é¡¹ç›®é…ç½®ï¼ˆğŸ”‘ è¯¦è§ä¸“ç”¨æŒ‡å—ï¼‰
â”œâ”€â”€ uv.lock                 # é€šç”¨é”æ–‡ä»¶ï¼ˆéœ€æäº¤åˆ° VCSï¼‰
â”œâ”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ CHANGELOG.md            # ç‰ˆæœ¬å†å²
â”œâ”€â”€ src/                    # æºä»£ç ï¼ˆæ¨èå¸ƒå±€ï¼‰
â”‚   â””â”€â”€ project_name/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py
â”‚       â””â”€â”€ modules/
â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_main.py
â”‚   â””â”€â”€ conftest.py
â”œâ”€â”€ docs/                   # æ–‡æ¡£æºç 
â”‚   â”œâ”€â”€ conf.py
â”‚   â””â”€â”€ index.md
â”œâ”€â”€ scripts/                # å·¥å…·è„šæœ¬
â”œâ”€â”€ .github/                # CI/CD å·¥ä½œæµ
â”‚   â””â”€â”€ workflows/
â””â”€â”€ requirements/           # ä¼ ç»Ÿä¾èµ–æ–‡ä»¶ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
    â”œâ”€â”€ base.txt
    â””â”€â”€ dev.txt
```

### é…ç½®æ–‡ä»¶æ¦‚è§ˆ

| æ–‡ä»¶ | ä½œç”¨ | ç®¡ç†æ–¹å¼ |
|------|------|----------|
| **pyproject.toml** | ğŸ¯ **æ ¸å¿ƒé…ç½®æ–‡ä»¶** | [å®Œæ•´æŒ‡å— â†’](pyproject-guide-zh-CN.md) |
| **requirements.txt** | ä¼ ç»Ÿä¾èµ–åˆ—è¡¨ | ç”¨ `uv pip compile` ç”Ÿæˆ |
| **Pipfile/Poetry.lock** | å…¶ä»–é”æ–‡ä»¶ | è¿ç§»åˆ° uv.lock |
| **setup.py/setup.cfg** | ä¼ ç»Ÿæ„å»ºè„šæœ¬ | è¿ç§»åˆ° pyproject.toml |
| **tox.ini** | æµ‹è¯•é…ç½® | åˆå¹¶åˆ° pyproject.toml |

### é¡¹ç›®å…ƒæ•°æ®ç¤ºä¾‹

```toml
[project]
name = "your-project"
version = "1.0.0"
description = "é¡¹ç›®ç®€è¦æè¿°"
readme = "README.md"
license = {text = "MIT"}
authors = [
    {name = "ä½ çš„åå­—", email = "your.email@example.com"}
]
maintainers = [
    {name = "ç»´æŠ¤è€…", email = "maintainer@example.com"}
]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
]
keywords = ["python", "engineering", "best-practices"]
requires-python = ">=3.8"
```

> **ğŸ“– æ·±å…¥é˜…è¯»**ï¼šå®Œæ•´ pyproject.toml é…ç½®è¯¦è§ [pyproject.toml å®Œæ•´æŒ‡å—](pyproject-guide-zh-CN.md)

---

## å¼€å‘ç¯å¢ƒç®¡ç†

### Python ç‰ˆæœ¬ç®¡ç†

| å·¥å…· | æ–¹å¼ | æ¨è |
|------|------|------|
| **uv python** | ä¸ uv é›†æˆ | âœ… **æ¨è** |
| **pyenv** | ç‹¬ç«‹ç‰ˆæœ¬ç®¡ç†å™¨ | âœ… å¯é€‰ |
| **ç³»ç»Ÿ Python** | æ“ä½œç³»ç»Ÿè‡ªå¸¦ | âš ï¸ ä¸æ¨èå¼€å‘ä½¿ç”¨ |
| **conda** | ç¯å¢ƒ+ç‰ˆæœ¬ç®¡ç† | âœ… æ•°æ®ç§‘å­¦é€‚ç”¨ |

#### uv Python ç®¡ç†ç¤ºä¾‹

```bash
# å®‰è£… Python ç‰ˆæœ¬
uv python install 3.11 3.12

# åˆ—å‡ºå¯ç”¨ç‰ˆæœ¬
uv python list

# å›ºå®šé¡¹ç›® Python ç‰ˆæœ¬
uv python pin 3.11

# ç”¨æŒ‡å®šç‰ˆæœ¬åˆ›å»ºç¯å¢ƒ
uv venv --python 3.11
```

### è™šæ‹Ÿç¯å¢ƒç­–ç•¥

| ç­–ç•¥ | å‘½ä»¤ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| **è‡ªåŠ¨ç®¡ç†** | `uv run script.py` | âœ… **æ¨è**æ—¥å¸¸å¼€å‘ |
| **æ˜¾å¼ venv** | `uv venv && source .venv/bin/activate` | ä¼ ç»Ÿå·¥ä½œæµ |
| **å¤šç¯å¢ƒ** | `uv venv .venv-dev`, `uv venv .venv-test` | éš”ç¦»ç¯å¢ƒ |
| **å®¹å™¨åŒ–** | Docker + uv | ç”Ÿäº§/éƒ¨ç½² |

### ç¯å¢ƒéš”ç¦»æœ€ä½³å®è·µ

1. **å¼€å‘ç»ä¸ä½¿ç”¨ç³»ç»Ÿ Python**
2. **å°† `.python-version` æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶**
3. **ä½¿ç”¨ç¯å¢ƒåˆ†ç»„ç®¡ç†ä¾èµ–**
4. **CI/CD è‡ªåŠ¨åŒ–ç¯å¢ƒåˆå§‹åŒ–**
5. **æ¸…æ™°è®°å½•ç¯å¢ƒéœ€æ±‚**

> **ğŸ“– æ·±å…¥é˜…è¯»**ï¼šuv ç”¨æ³•è¯¦è§ [uv å®Œæ•´æŒ‡å—](uv-guide-zh-CN.md)

---

## ä»£ç è´¨é‡ä¸è§„èŒƒ

### ç°ä»£ä»£ç è´¨é‡å·¥å…·æ ˆ

| ç±»åˆ« | ç°ä»£å·¥å…· | ä¼ ç»Ÿå·¥å…· | ä¼˜åŠ¿ |
|------|----------|---------|------|
| **Lint** | Ruff | Pylint, Flake8 | 10-100å€é€Ÿåº¦ï¼Œè§„åˆ™å…¨é¢ |
| **æ ¼å¼åŒ–** | Ruff Format | Black, autopep8 | ä¸ linter ä¸€ä½“ï¼Œå¿« |
| **ç±»å‹æ£€æŸ¥** | MyPy | æ— éœ€ | é™æ€ç±»å‹éªŒè¯ |
| **å¯¼å…¥æ’åº** | Ruff | isort | Ruff å†…ç½® |
| **å®‰å…¨** | Ruff (bandit) | bandit, safety | é›†æˆæ›´å¿« |

### ä»£ç è´¨é‡å®ç°

#### pyproject.toml å®Œæ•´é…ç½®

```toml
[tool.ruff]
line-length = 88
target-version = "py38"

[tool.ruff.lint]
select = ["E", "F", "W", "I", "N", "B", "C90", "UP", "S"]
ignore = ["E501", "B008"]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]
"tests/*" = ["S101"]

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
line-ending = "auto"

[tool.mypy]
python_version = "3.8"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
```

### Pre-commit é›†æˆ

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.0
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.0.0
    hooks:
      - id: mypy
        additional_dependencies: [types-requests]
```

### CI/CD è´¨é‡é—¨æ§›

```yaml
# GitHub Actions
- name: ä»£ç è´¨é‡æ£€æŸ¥
  run: |
    uv run ruff check src/
    uv run ruff format --check src/
    uv run mypy src/
    uv run pytest --cov=src --cov-fail-under=80
```

> **ğŸ“– æ·±å…¥é˜…è¯»**ï¼šå·¥å…·å¯¹æ¯”è¯¦è§ [Python ä»£ç è´¨é‡å·¥å…·ç®€ä»‹](python-tools-introduction-zh-CN.md)

---

## æµ‹è¯•ä¸è´¨é‡ä¿éšœ

### æµ‹è¯•é‡‘å­—å¡”

| å±‚çº§ | ç›®çš„ | å·¥å…· | è¦†ç›–ç›®æ ‡ |
|------|------|------|----------|
| **å•å…ƒæµ‹è¯•** | æµ‹è¯•å•ä¸ªå‡½æ•°/æ–¹æ³• | pytest, unittest | 80-90%+ |
| **é›†æˆæµ‹è¯•** | æµ‹è¯•ç»„ä»¶äº¤äº’ | pytest, testcontainers | 60-70% |
| **ç«¯åˆ°ç«¯æµ‹è¯•** | æµ‹è¯•å®Œæ•´æµç¨‹ | playwright, selenium | 20-30% |
| **æ€§èƒ½æµ‹è¯•** | å…³é”®è·¯å¾„åŸºå‡† | pytest-benchmark, locust | å…³é”®æŒ‡æ ‡ |

### ç°ä»£æµ‹è¯•é…ç½®

#### pytest é…ç½® (pyproject.toml)

```toml
[tool.pytest.ini_options]
minversion = "7.0"
addopts = ["-ra", "-q", "--strict-markers", "--strict-config", "--cov=src", "--cov-report=term-missing", "--cov-report=html", "--cov-report=xml", "--cov-fail-under=80"]
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
markers = ["slow: æ ‡è®°æ…¢æµ‹è¯•", "integration: æ ‡è®°é›†æˆæµ‹è¯•", "unit: æ ‡è®°å•å…ƒæµ‹è¯•", "network: æ ‡è®°éœ€ç½‘ç»œ", "flaky: æ ‡è®°ä¸ç¨³å®šæµ‹è¯•"]
```

#### æµ‹è¯•ç»“æ„ç¤ºä¾‹

```
tests/
â”œâ”€â”€ conftest.py              # pytest é…ç½®ä¸å¤¹å…·
â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ test_models.py
â”‚   â””â”€â”€ test_utils.py
â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ test_api.py
â”‚   â””â”€â”€ test_database.py
â”œâ”€â”€ e2e/                     # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â””â”€â”€ test_workflows.py
â””â”€â”€ fixtures/                # æµ‹è¯•æ•°æ®ä¸ mock
    â”œâ”€â”€ sample_data.json
    â””â”€â”€ mock_responses.py
```

### è´¨é‡ä¿éšœå®è·µ

#### 1. æµ‹è¯•é©±åŠ¨å¼€å‘ (TDD)

```bash
# TDD æµç¨‹
# 1. å†™å¤±è´¥æµ‹è¯•
# 2. ç¼–å†™é€šè¿‡æµ‹è¯•çš„æœ€å°ä»£ç 
# 3. é‡æ„
# 4. å¾ªç¯

# æŒç»­è¿è¡Œæµ‹è¯•
uv run pytest --watch src/ tests/
```

#### 2. æ€§è´¨æµ‹è¯•ï¼ˆå±æ€§æµ‹è¯•ï¼‰

```python
import hypothesis
from hypothesis import strategies as st

@given(st.integers(min_value=0, max_value=100))
def test_additive_identity(x):
    assert x + 0 == x

@given(st.lists(st.integers()))
def test_sort_preserves_elements(lst):
    sorted_lst = sorted(lst)
    assert sorted(lst).count == lst.count
```

#### 3. å˜å¼‚æµ‹è¯•

```bash
# å®‰è£… mutmut
uv add --dev mutmut

# è¿è¡Œå˜å¼‚æµ‹è¯•
uv run mutmut run --paths-to-mutate src/

# é«˜å˜å¼‚åˆ†æ•°è¡¨ç¤ºæµ‹è¯•è¦†ç›–å¥½
```

---

## ä¾èµ–ç®¡ç†

### uv çš„ç°ä»£ä¾èµ–ç®¡ç†

| åŠŸèƒ½ | ä¼ ç»Ÿï¼ˆpipï¼‰ | ç°ä»£ï¼ˆuvï¼‰ |
|------|-------------|------------|
| **å®‰è£…é€Ÿåº¦** | æ…¢ï¼ˆç§’çº§ï¼‰ | å¿«ï¼ˆæ¯«ç§’çº§ï¼‰ |
| **ä¾èµ–è§£æ** | åŸºç¡€è§£æå™¨ | é«˜çº§è§£æå™¨ |
| **é”æ–‡ä»¶** | requirements.txt | é€šç”¨ uv.lock |
| **ç¯å¢ƒç®¡ç†** | å¤šå·¥å…·åˆ†ç¦» | ä¸€ä½“åŒ– |
| **è·¨å¹³å°** | å¹³å°ç›¸å…³ | é€šç”¨é”æ–‡ä»¶ |

### ä¾èµ–åˆ†ç±»

#### ç”Ÿäº§ä¾èµ–
```bash
# æ·»åŠ ç”Ÿäº§ä¾èµ–
uv add requests fastapi sqlalchemy
uv add 'requests>=2.28.0,<3.0.0'  # ç‰ˆæœ¬çº¦æŸ
uv add 'fastapi[all]'             # å« extras
```

#### å¼€å‘ä¾èµ–
```bash
# æ·»åŠ å¼€å‘å·¥å…·
uv add --dev pytest black ruff mypy
uv add --group test pytest-cov
uv add --group docs sphinx
```

#### å¯é€‰ä¾èµ–
```toml
[project.optional-dependencies]
dev = ["pytest>=7.0.0", "black>=23.0.0", "ruff>=0.1.0", "mypy>=1.0.0"]
docs = ["sphinx>=5.0.0", "sphinx-rtd-theme>=1.0.0"]
test = ["pytest>=7.0.0", "pytest-cov>=4.0.0", "pytest-xdist>=3.0.0"]
```

### é”æ–‡ä»¶ç®¡ç†

```bash
# åˆ›å»º/æ›´æ–°é”æ–‡ä»¶
uv lock

# æ›´æ–°æŒ‡å®šåŒ…
uv lock --upgrade-package requests

# åˆ·æ–°é”æ–‡ä»¶ï¼ˆå¿½ç•¥ç¼“å­˜ï¼‰
uv lock --refresh

# æ£€æŸ¥è¿‡æœŸåŒ…
uv tree --outdated
```

### å®‰å…¨æ‰«æ

```bash
# æ£€æŸ¥å·²çŸ¥æ¼æ´
uv pip check

# CI é›†æˆå®‰å…¨æ‰«æ
- name: å®‰å…¨æ‰«æ
  run: |
    uv pip check
    uv pip list --format json | uv pip audit --require-from -
```

---

## æŒç»­é›†æˆä¸éƒ¨ç½²

### CI/CD æµæ°´çº¿ç»“æ„

```mermaid
graph LR
    A[Push] --> B[Lint]
    B --> C[Test]
    C --> D[Security]
    D --> E[Build]
    E --> F[Deploy Staging]
    F --> G[Integration Tests]
    G --> H[Deploy Production]
```

### GitHub Actions æœ€ä½³å®è·µ

#### å®Œæ•´ CI å·¥ä½œæµ

```yaml
name: Python CI/CD

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.8", "3.9", "3.10", "3.11", "3.12"]
    steps:
      - uses: actions/checkout@v4
      - name: è®¾ç½® uv
        uses: astral-sh/setup-uv@v3
        with:
          version: "latest"
      - name: è®¾ç½® Python ${{ matrix.python-version }}
        run: uv python install ${{ matrix.python-version }}
      - name: ç¼“å­˜ä¾èµ–
        uses: actions/cache@v3
        with:
          path: ~/.cache/uv
          key: ${{ runner.os }}-uv-${{ hashFiles('pyproject.toml', 'uv.lock') }}
      - name: å®‰è£…ä¾èµ–
        run: uv sync --all-extras
      - name: ä»£ç è´¨é‡æ£€æŸ¥
        run: |
          uv run ruff check src/
          uv run ruff format --check src/
          uv run mypy src/
      - name: è¿è¡Œæµ‹è¯•
        run: |
          uv run pytest --cov=src --cov-report=xml
      - name: ä¸Šä¼ è¦†ç›–ç‡
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage.xml
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: astral-sh/setup-uv@v3
      - name: å®‰å…¨å®¡è®¡
        run: |
          uv sync
          uv pip check
          uv pip list --format json | uv pip audit --require-from -
  build:
    needs: [test, security]
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    steps:
      - uses: actions/checkout@v4
      - uses: astral-sh/setup-uv@v3
      - name: æ„å»ºåˆ†å‘åŒ…
        run: uv build
      - name: å­˜å‚¨æ„å»ºäº§ç‰©
        uses: actions/upload-artifact@v3
        with:
          name: dist
          path: dist/
  publish:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4
      - uses: astral-sh/setup-uv@v3
      - name: ä¸‹è½½äº§ç‰©
        uses: actions/download-artifact@v3
        with:
          name: dist
          path: dist/
      - name: å‘å¸ƒåˆ° PyPI
        run: uv publish
        env:
          UV_PUBLISH_TOKEN: ${{ secrets.PYPI_TOKEN }}
```

### éƒ¨ç½²ç­–ç•¥

| ç­–ç•¥ | æè¿° | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **è“ç»¿éƒ¨ç½²** | ä¸¤å¥—ç¯å¢ƒåˆ‡æ¢ | é›¶åœæœºéƒ¨ç½² |
| **é‡‘ä¸é›€** | éƒ¨åˆ†ç”¨æˆ·æ¸è¿›å‘å¸ƒ | é£é™©å‘å¸ƒ |
| **æ»šåŠ¨æ›´æ–°** | é€æ­¥æ›¿æ¢å®ä¾‹ | æœ‰çŠ¶æ€åº”ç”¨ |
| **GitOps** | Git é©±åŠ¨éƒ¨ç½² | äº‘åŸç”Ÿ/Kubernetes |

### ç›‘æ§ä¸å¯è§‚æµ‹æ€§

#### åº”ç”¨ç›‘æ§ç¤ºä¾‹

```python
# ç»“æ„åŒ–æ—¥å¿—
import logging
import json
from datetime import datetime

class StructuredLogger:
    def __init__(self, name: str):
        self.logger = logging.getLogger(name)
    def log_event(self, event: str, level: str = "INFO", **kwargs):
        log_data = {
            "timestamp": datetime.utcnow().isoformat(),
            "event": event,
            "level": level,
            **kwargs
        }
        getattr(self.logger, level.lower())(json.dumps(log_data))

# ç”¨æ³•
logger = StructuredLogger(__name__)
logger.log_event("user_login", user_id="123", ip="192.168.1.1")
```

---

## æ–‡æ¡£ä¸ç»´æŠ¤

### æ–‡æ¡£ç­–ç•¥

| ç±»å‹ | ä½œç”¨ | å·¥å…· | ä½ç½® |
|------|------|------|------|
| **API æ–‡æ¡£** | ä»£ç å‚è€ƒ | Sphinx, pdoc | docs/api/ |
| **ç”¨æˆ·æŒ‡å—** | ä½¿ç”¨æ•™ç¨‹ | MkDocs, GitBook | docs/guide/ |
| **æ¶æ„æ–‡æ¡£** | ç³»ç»Ÿè®¾è®¡ | Markdown, å›¾ç¤º | docs/architecture/ |
| **å˜æ›´æ—¥å¿—** | ç‰ˆæœ¬å†å² | Towncrier, æ‰‹å·¥ | CHANGELOG.md |
| **è´¡çŒ®æŒ‡å—** | å¼€å‘æµç¨‹ | Markdown | CONTRIBUTING.md |

### æ–‡æ¡£è‡ªåŠ¨åŒ–

#### Sphinx é…ç½®

```toml
[tool.sphinx]
source-dir = "docs"
build-dir = "docs/_build"

[tool.sphinx.config]
project = "My Project"
author = "ä½ çš„åå­—"
release = "1.0.0"
extensions = ["sphinx.ext.autodoc", "sphinx.ext.viewcode", "sphinx.ext.napoleon", "myst_parser"]
html_theme = "sphinx_rtd_theme"
```

#### CI è‡ªåŠ¨åŒ–æ–‡æ¡£

```yaml
- name: æ„å»ºæ–‡æ¡£
  run: |
    uv add --group docs sphinx sphinx-rtd-theme
    uv run sphinx-build -b html docs/ docs/_build/
- name: éƒ¨ç½²æ–‡æ¡£
  if: github.ref == 'refs/heads/main'
  uses: peaceiris/actions-gh-pages@v3
  with:
    github_token: ${{ secrets.GITHUB_TOKEN }}
    publish_dir: ./docs/_build/
```

### ç»´æŠ¤å®è·µ

#### 1. å®šæœŸæ›´æ–°

```bash
# æ£€æŸ¥è¿‡æœŸä¾èµ–
uv tree --outdated
# å®‰å…¨æ›´æ–°ä¾èµ–
uv lock --upgrade
# äº¤äº’å¼ä¾èµ–å®¡æŸ¥
pip-review --interactive
```

#### 2. ä¾èµ–å¥åº·ç›‘æ§

```yaml
# æ¯å‘¨ä¾èµ–æ£€æŸ¥
name: Dependency Health
on:
  schedule:
    - cron: "0 0 * * 1"  # æ¯å‘¨ä¸€
jobs:
  dependency-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: astral-sh/setup-uv@v3
      - name: æ£€æŸ¥ä¾èµ–
        run: |
          uv sync
          uv pip check
          pip-audit --requirement uv.lock
```

#### 3. æ€§èƒ½ç›‘æ§

```python
# æ€§èƒ½åŸºå‡†æµ‹è¯•
import pytest
import time

@pytest.mark.performance
def test_api_response_time():
    start_time = time.time()
    response = api_call()
    response_time = time.time() - start_time
    assert response_time < 0.1, f"å“åº”è¿‡æ…¢: {response_time}s"
```

---

## æ€§èƒ½ä¸ä¼˜åŒ–

### Python åº”ç”¨æ€§èƒ½åˆ†æ

| å·¥å…· | ç”¨é€” | é›†æˆæ–¹å¼ |
|------|------|----------|
| **cProfile** | å†…ç½®åˆ†æ | `python -m cProfile script.py` |
| **py-spy** | ç”Ÿäº§åˆ†æ | é‡‡æ ·åˆ†æå™¨ |
| **memory-profiler** | å†…å­˜åˆ†æ | è¡Œçº§å†…å­˜ |
| **line-profiler** | CPU çƒ­ç‚¹åˆ†æ | è¡Œçº§æ—¶é—´ |

#### æ€§èƒ½æµ‹è¯•è®¾ç½®

```python
# conftest.py
import pytest
import time

@pytest.fixture
def benchmark():
    """ç®€å•åŸºå‡†å¤¹å…·"""
    def _benchmark(func, *args, iterations=1000, **kwargs):
        start = time.perf_counter()
        for _ in range(iterations):
            func(*args, **kwargs)
        end = time.perf_counter()
        return (end - start) / iterations
    return _benchmark

# test_performance.py
def test_function_performance(benchmark):
    avg_time = benchmark(my_function, test_data)
    assert avg_time < 0.001, f"å‡½æ•°è¿‡æ…¢: {avg_time:.6f}s"
```

### ä¼˜åŒ–ç­–ç•¥

#### 1. ç®—æ³•ä¼˜åŒ–

```python
# å‰: O(nÂ²) åµŒå¥—å¾ªç¯
def find_duplicates_slow(items):
    duplicates = []
    for i, item1 in enumerate(items):
        for j, item2 in enumerate(items[i+1:], i+1):
            if item1 == item2 and item1 not in duplicates:
                duplicates.append(item1)
    return duplicates

# å: O(n) ç”¨é›†åˆ
def find_duplicates_fast(items):
    seen = set()
    duplicates = set()
    for item in items:
        if item in seen:
            duplicates.add(item)
        seen.add(item)
    return list(duplicates)
```

#### 2. å†…å­˜ä¼˜åŒ–

```python
# å†…å­˜é«˜æ•ˆå¤„ç†å¤§æ–‡ä»¶
def process_large_file(filename):
    """ä¸åŠ è½½åˆ°å†…å­˜å¤„ç†å¤§æ–‡ä»¶"""
    with open(filename, 'r') as f:
        for line in f:
            yield process_line(line)

# ç”Ÿæˆå™¨è¡¨è¾¾å¼ vs åˆ—è¡¨æ¨å¯¼
# ä¸æ¨è: å…¨éƒ¨åŠ è½½åˆ°å†…å­˜
squares = [x**2 for x in range(1000000)]
# æ¨è: ç”Ÿæˆå™¨ï¼Œæœ€å°å†…å­˜
squares = (x**2 for x in range(1000000))
```

#### 3. ç¼“å­˜ç­–ç•¥

```python
from functools import lru_cache
import joblib
import diskcache as dc

# å†…å­˜ç¼“å­˜
@lru_cache(maxsize=128)
def expensive_computation(x, y):
    return complex_calculation(x, y)

# ç£ç›˜ç¼“å­˜
cache = dc.Cache('./cache_dir')
@cache.memoize()
def large_computation(data):
    result = process_large_data(data)
    return result

# joblib å‡½æ•°ç¼“å­˜
@joblib.Memory('./joblib_cache', verbose=0).cache
def ml_model_prediction(features):
    model = load_model()
    return model.predict(features)
```

---

## å®‰å…¨æœ€ä½³å®è·µ

### å®‰å…¨æ£€æŸ¥è¡¨

| ç±»åˆ« | å®è·µ | å®ç°æ–¹å¼ |
|------|------|----------|
| **ä¾èµ–** | å®šæœŸå®‰å…¨å®¡è®¡ | `uv pip audit`, Dependabot |
| **è¾“å…¥æ ¡éªŒ** | æ‰€æœ‰è¾“å…¥éƒ½éœ€æ ¡éªŒ | Pydantic, validators |
| **è®¤è¯** | ä½¿ç”¨å®‰å…¨è®¤è¯æ¨¡å¼ | JWT, OAuth2 |
| **æ•°æ®ä¿æŠ¤** | åŠ å¯†æ•æ„Ÿæ•°æ® | cryptography, Fernet |
| **ç¯å¢ƒå˜é‡** | ä¸æäº¤å¯†é’¥ | `.env` æ–‡ä»¶ã€å¯†é’¥åº“ |
| **é”™è¯¯å¤„ç†** | ä¸æš´éœ²å†…éƒ¨ä¿¡æ¯ | è‡ªå®šä¹‰é”™è¯¯é¡µ |
| **HTTPS** | å¼ºåˆ¶ TLS | è¯ä¹¦ã€HSTS |

### å®‰å…¨å®ç°ç¤ºä¾‹

#### Pydantic è¾“å…¥æ ¡éªŒ

```python
from pydantic import BaseModel, EmailStr, validator
import re

class UserRegistration(BaseModel):
    username: str
    email: EmailStr
    password: str
    @validator('username')
    def validate_username(cls, v):
        if len(v) < 3 or len(v) > 20:
            raise ValueError('ç”¨æˆ·åéœ€ 3-20 å­—ç¬¦')
        if not re.match(r'^[a-zA-Z0-9_]+$', v):
            raise ValueError('ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿')
        return v
    @validator('password')
    def validate_password(cls, v):
        if len(v) < 8:
            raise ValueError('å¯†ç è‡³å°‘ 8 ä½')
        if not re.search(r'[A-Z]', v):
            raise ValueError('å¯†ç éœ€åŒ…å«å¤§å†™å­—æ¯')
        if not re.search(r'[a-z]', v):
            raise ValueError('å¯†ç éœ€åŒ…å«å°å†™å­—æ¯')
        if not re.search(r'\d', v):
            raise ValueError('å¯†ç éœ€åŒ…å«æ•°å­—')
        return v
```

#### å®‰å…¨é…ç½®ç®¡ç†

```python
import os
from typing import Optional
from cryptography.fernet import Fernet

class SecureConfig:
    def __init__(self):
        self._encryption_key = self._load_or_create_key()
        self._cipher = Fernet(self._encryption_key)
    def _load_or_create_key(self) -> bytes:
        key_file = os.environ.get('ENCRYPTION_KEY_FILE', '.encryption_key')
        if os.path.exists(key_file):
            with open(key_file, 'rb') as f:
                return f.read()
        else:
            key = Fernet.generate_key()
            with open(key_file, 'wb') as f:
                f.write(key)
            os.chmod(key_file, 0o600)
            return key
    def encrypt_sensitive_data(self, data: str) -> str:
        return self._cipher.encrypt(data.encode()).decode()
    def decrypt_sensitive_data(self, encrypted_data: str) -> str:
        return self._cipher.decrypt(encrypted_data.encode()).decode()
    def get_database_url(self) -> str:
        encrypted_url = os.environ.get('DATABASE_URL_ENCRYPTED')
        if encrypted_url:
            return self.decrypt_sensitive_data(encrypted_url)
        raise ValueError("æœªæ‰¾åˆ°æˆ–æœªåŠ å¯†æ•°æ®åº“ URL")
```

#### å®‰å…¨å¤´ä¸­é—´ä»¶

```python
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.middleware.trustedhost import TrustedHostMiddleware

app = FastAPI()

@app.middleware("http")
async def add_security_headers(request: Request, call_next):
    response = await call_next(request)
    response.headers["X-Content-Type-Options"] = "nosniff"
    response.headers["X-Frame-Options"] = "DENY"
    response.headers["X-XSS-Protection"] = "1; mode=block"
    response.headers["Strict-Transport-Security"] = "max-age=31536000; includeSubDomains"
    response.headers["Content-Security-Policy"] = "default-src 'self'"
    return response

app.add_middleware(
    TrustedHostMiddleware, 
    allowed_hosts=["yourdomain.com", "*.yourdomain.com"]
)
app.add_middleware(
    CORSMiddleware,
    allow_origins=["https://yourdomain.com"],
    allow_credentials=True,
    allow_methods=["GET", "POST"],
    allow_headers=["*"],
)
```

### å®‰å…¨æµ‹è¯•

```python
import pytest
from fastapi.testclient import TestClient
from your_app import app

client = TestClient(app)

def test_sql_injection_protection():
    """SQL æ³¨å…¥é˜²æŠ¤æµ‹è¯•"""
    malicious_input = "'; DROP TABLE users; --"
    response = client.post("/search", json={"query": malicious_input})
    assert response.status_code != 500
    assert "error" in response.json().lower()

def test_xss_protection():
    """XSS é˜²æŠ¤æµ‹è¯•"""
    xss_payload = "<script>alert('xss')</script>"
    response = client.post("/comment", json={"text": xss_payload})
    assert "<script>" not in response.text

def test_rate_limiting():
    """é™æµæµ‹è¯•"""
    for _ in range(100):
        response = client.post("/api/endpoint")
    assert response.status_code == 429
```

---

## èµ„æºé“¾æ¥ä¸æ‰©å±•é˜…è¯»

### å®˜æ–¹æ–‡æ¡£

| ä¸»é¢˜ | èµ„æº | é“¾æ¥ |
|------|------|------|
| **Python æ‰“åŒ…** | æ‰“åŒ…ç”¨æˆ·æŒ‡å— | https://packaging.python.org/ |
| **PEP æ ‡å‡†** | Python å¢å¼ºææ¡ˆ | https://peps.python.org/ |
| **uv æ–‡æ¡£** | å®˜æ–¹ uv æŒ‡å— | https://docs.astral.sh/uv/ |
| **Ruff æ–‡æ¡£** | å®˜æ–¹ Ruff æŒ‡å— | https://docs.astral.sh/ruff/ |
| **pytest æ–‡æ¡£** | pytest æµ‹è¯•æŒ‡å— | https://docs.pytest.org/ |
| **MyPy æ–‡æ¡£** | é™æ€ç±»å‹æ£€æŸ¥ | https://mypy.readthedocs.io/ |

### æœ¬ä»“åº“ä¸“ç”¨æŒ‡å—

| æŒ‡å— | é‡ç‚¹ | é“¾æ¥ |
|------|------|------|
| **[pyproject.toml æŒ‡å—](pyproject-guide-zh-CN.md)** | é¡¹ç›®å®Œæ•´é…ç½® | ğŸ”— æœ¬åœ° |
| **[uv æŒ‡å—](uv-guide-zh-CN.md)** | ç°ä»£ä¾èµ–ç®¡ç† | ğŸ”— æœ¬åœ° |
| **[ä»£ç è´¨é‡å·¥å…·](python-tools-introduction-zh-CN.md)** | Lintã€æ ¼å¼åŒ–ã€ç±»å‹æ£€æŸ¥ | ğŸ”— æœ¬åœ° |

### ç¤¾åŒºèµ„æº

| èµ„æº | ç±»å‹ | æè¿° |
|------|------|------|
| **Python Discourse** | ç¤¾åŒºè®ºå› | å®˜æ–¹ Python è®¨è®ºåŒº |
| **Reddit r/Python** | ç¤¾åŒº | Python æ–°é—»ä¸è®¨è®º |
| **Real Python** | æ•™ç¨‹ | æ·±åº¦ Python æ•™ç¨‹ |
| **Python Weekly** | å‘¨æŠ¥ | æ¯å‘¨ Python æ–°é—»ä¸æ–‡ç«  |
| **Talk Python Podcast** | æ’­å®¢ | Python è®¿è°ˆä¸è®¨è®º |

### ä¹¦ç±ä¸è¯¾ç¨‹

| èµ„æº | éš¾åº¦ | é‡ç‚¹ |
|------|------|------|
| **Effective Python** | ä¸­çº§ | æœ€ä½³å®è·µä¸æƒ¯ç”¨æ³• |
| **Fluent Python** | é«˜çº§ | æ·±å…¥ Python å†…éƒ¨ |
| **Architecture Patterns with Python** | é«˜çº§ | ç³»ç»Ÿè®¾è®¡æ¨¡å¼ |
| **Python for DevOps** | ä¸­çº§ | DevOps è‡ªåŠ¨åŒ– |
| **Test-Driven Development with Python** | ä¸­çº§ | TDD æ–¹æ³•è®º |

### å·¥å…·ä¸åº“

| ç±»åˆ« | æ¨èå·¥å…· |
|------|----------|
| **ä¾èµ–ç®¡ç†** | uv, pip, conda |
| **ä»£ç è´¨é‡** | Ruff, MyPy, Black |
| **æµ‹è¯•** | pytest, pytest-cov, pytest-mock |
| **æ–‡æ¡£** | Sphinx, MkDocs, pdoc |
| **Web æ¡†æ¶** | FastAPI, Django, Flask |
| **æ•°æ®ç§‘å­¦** | pandas, numpy, scikit-learn |
| **DevOps** | Docker, Kubernetes, GitHub Actions |

---

## æ€»ç»“ä¸å…³é”®è¦ç‚¹

### å·¥ç¨‹åŸåˆ™å›é¡¾

1. **è‡ªåŠ¨åŒ–ä¸€åˆ‡**ï¼šç”¨å·¥å…·æ¶ˆé™¤é‡å¤åŠ³åŠ¨
2. **ä¸€è‡´æ€§è‡³ä¸Š**ï¼šæ ‡å‡†åŒ–å·¥å…·ã€æµç¨‹å’Œä»£ç é£æ ¼
3. **è´¨é‡ä¼˜å…ˆ**ï¼šä»ç¬¬ä¸€å¤©èµ·æ³¨é‡è´¨é‡
4. **å®‰å…¨è®¾è®¡**ï¼šå…¨æµç¨‹å®æ–½å®‰å…¨æªæ–½
5. **æ€§èƒ½æ„è¯†**ï¼šç¼–å†™é«˜æ•ˆä»£ç å¹¶æµ‹é‡æ€§èƒ½
6. **æ–‡æ¡£å³ä»£ç **ï¼šæŠŠæ–‡æ¡£è§†ä¸ºä»£ç çš„ä¸€éƒ¨åˆ†
7. **æŒç»­æ”¹è¿›**ï¼šå®šæœŸæ›´æ–°ä¾èµ–å’Œå®è·µ

### æ¨èå·¥å…·æ ˆï¼ˆ2024ï¼‰

| ç›®çš„ | å·¥å…· | ç†ç”± |
|------|------|------|
| **ä¾èµ–ç®¡ç†** | **uv** | 10-100å€é€Ÿåº¦ï¼Œå·¥å…·é“¾ä¸€ä½“åŒ– |
| **é¡¹ç›®é…ç½®** | **pyproject.toml** | æ ‡å‡†ã€å…¨é¢é…ç½® |
| **ä»£ç è´¨é‡** | **Ruff + MyPy** | å¿«é€Ÿã€å…¨é¢ã€ç°ä»£ |
| **æµ‹è¯•** | **pytest** | åŠŸèƒ½ä¸°å¯Œï¼Œæ’ä»¶ç”Ÿæ€ |
| **æ–‡æ¡£** | **Sphinx/MkDocs** | ä¸“ä¸šã€è‡ªåŠ¨ç”Ÿæˆ |
| **CI/CD** | **GitHub Actions** | é›†æˆã€çµæ´»ã€å…è´¹ |

### è¿ç§»è·¯å¾„

1. **ä¼˜å…ˆç”¨ uv**ï¼šç«‹å³æ›¿æ¢ pip
2. **ç»Ÿä¸€é…ç½®**ï¼šå°†æ‰€æœ‰é…ç½®åˆå¹¶åˆ° pyproject.toml
3. **é‡‡ç”¨ Ruff**ï¼šæ›¿æ¢å¤šå·¥å…·ä¸º Ruff
4. **å®Œå–„æµ‹è¯•**ï¼šé…ç½® pytest ä¸è¦†ç›–ç‡
5. **é›†æˆ CI/CD**ï¼šè‡ªåŠ¨åŒ–è´¨é‡ä¸éƒ¨ç½²
6. **å®Œå–„æ–‡æ¡£**ï¼šåˆ›å»ºå…¨é¢æ–‡æ¡£

### ä¸‹ä¸€æ­¥å»ºè®®

1. **è¯„ä¼°ç°çŠ¶**ï¼šåˆ†æç°æœ‰å·¥å…·ä¸æµç¨‹
2. **åˆ¶å®šè¿ç§»è®¡åˆ’**ï¼šé€æ­¥é‡‡ç”¨ç°ä»£å®è·µ
3. **å°æ­¥å¿«è·‘**ï¼šä¼˜å…ˆé«˜å½±å“å˜æ›´ï¼ˆuvã€Ruffï¼‰
4. **è¡¡é‡æ•ˆæœ**ï¼šè·Ÿè¸ªé€Ÿåº¦ã€è´¨é‡ä¸å¼€å‘ä½“éªŒæå‡
5. **æŒç»­è¿­ä»£**ï¼šä¸æ–­ä¼˜åŒ–å·¥ç¨‹å®è·µ

---

*æœ¬æŒ‡å—ä¸º Python å·¥ç¨‹å®è·µçš„å…¨é¢ç»¼è¿°ã€‚å…·ä½“å·¥å…·å’Œé…ç½®ç»†èŠ‚è¯·å‚è€ƒæ–‡ä¸­é“¾æ¥çš„ä¸“ç”¨æŒ‡å—ã€‚*